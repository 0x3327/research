<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.64">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Milos Bojinovic">
  <title>3327 Research - Detect NFT Wash Trading</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../../">
  <script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="3327 Research - Detect NFT Wash Trading">
<meta property="og:site-name" content="3327 Research">
<meta name="twitter:title" content="3327 Research - Detect NFT Wash Trading">
<meta name="twitter:card" content="summary">
</head>
<body>
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../../index.html">
    <img src="../../../logo.png" alt="">
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">Overview</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../documents/research/index.html">Research</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/3327_io"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0x3327/research"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a></li>
<li><a href="#introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
<li><a href="#goals-methodology" class="nav-link" data-scroll-target="#goals-methodology">Goals &amp; Methodology</a></li>
<li><a href="#results-discussion" class="nav-link" data-scroll-target="#results-discussion">Results &amp; Discussion</a>
<ul class="collapse">
<li><a href="#wash-trading-patterns" class="nav-link" data-scroll-target="#wash-trading-patterns">Wash Trading Patterns</a></li>
<li><a href="#collecting-and-parsing-of-data" class="nav-link" data-scroll-target="#collecting-and-parsing-of-data">Collecting and Parsing of Data</a></li>
<li><a href="#wash-trading-detectors" class="nav-link" data-scroll-target="#wash-trading-detectors">Wash Trading Detectors</a></li>
<li><a href="#implementation" class="nav-link" data-scroll-target="#implementation">Implementation</a>
<ul class="collapse">
<li><a href="#example" class="nav-link" data-scroll-target="#example">Example</a></li>
<li><a href="#implications" class="nav-link" data-scroll-target="#implications">Implications</a></li>
</ul></li>
</ul></li>
<li><a href="#conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
<li><a href="#appendices" class="nav-link" data-scroll-target="#appendices">Appendices</a>
<ul class="collapse">
<li><a href="#appendix-a" class="nav-link" data-scroll-target="#appendix-a">Appendix A</a></li>
<li><a href="#appendix-b" class="nav-link" data-scroll-target="#appendix-b">Appendix B</a></li>
</ul></li>
<li><a href="#bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
</ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/0x3327/research/edit/main/documents/research/posts/ERFC-90.gfm.md" class="toc-action">Edit this page</a></p><p><a href="https://github.com/0x3327/research/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">




<div class="quarto-title"><h1 class="title display-7">Detect NFT Wash Trading</h1><p class="subtitle lead">ERFC - 90</p></div><div class="quarto-title-meta"><div><div class="quarto-title-meta-heading">Author</div><div class="quarto-title-meta-contents"><div class="quarto-title-authors"><p>Milos Bojinovic</p></div></div></div><div><div class="quarto-title-meta-heading">Published</div><div class="quarto-title-meta-contents"><p class="date">3/12/2022</p></div></div></div></header>

<section id="executive-summary" class="level1">
<h1>Executive Summary</h1>
<p>With the monthly trading volume of the <strong>Non-Fungible Token (NFT)</strong> marketplace <a href="https://opensea.io">OpenSea</a> reaching 5 billion dollars in January 2022<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> it is clear that NFTs are gaining popularity and with that grows the importance of having a transparent trading activity.</p>
<p><strong>Wash trading</strong> is a form of market manipulation where a single entity or a group of colluding entities buy and sell the same asset with the goal of feeding the marketplace misleading information<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. There are at least two possible benefits to wash trading, the first being that a single asset can be wash traded multiple times, continually increasing the price, thus making the asset appear more sought after than it actually is. This chain of wash trades is broken when an unsuspecting victim buys the asset. The second potential benefit is that the trading can be incentivized by the platform, with rewards being tied to the volume traded. Trading rewards can, at least for a limited time period, be higher than the fees, which makes this process worthwhile.</p>
<p>In the case of NFTs, wash trading is additionally enabled by the associated user anonymity. One single entity can control a large number of addresses without a way of reliably determining who is behind them. Those addresses, however, need to be somehow funded to make them usable, which leads to a money trail that can be followed to detect connections between them and to flag suspicious NFT trades.</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Currently, only <a href="https://nansen.ai">Nansen</a>, a blockchain analytics platform that requires a paid subscription, offers a feature called “Wash Trading Filter” where users can see the metrics (volume, average price, etc.) for an NFT collection with and without the filter but cannot browse through the individual NFTs. Another drawback is that Nansen doesn’t disclose how the filter works, and so the question of why some trades were flagged remains.</p>
<p>Data on the blockchain is public, but it is hard to extract specific pieces of information from it. Detecting if a particular NFT was wash traded would require collecting every single trade that was made on all of the marketplaces and checking if the addresses involved in it are connected in some way. This data would need to be safely stored and effectively parsed to enable answering if any arbitrarily chosen NFT has been wash traded. The detection algorithm should also provide adequate reasoning on why a specific trade has been flagged. Developing and publicly disclosing the inner workings of such an algorithm would add more transparency to NFT trading, but it would inevitably lead to the creation of more intricate patterns that would not get caught if the algorithm is not regularly updated.</p>
</section>
<section id="goals-methodology" class="level1">
<h1>Goals &amp; Methodology</h1>
<p><strong>The goals</strong> of this research are to :</p>
<ul>
<li>define what transaction patterns classify as a wash trade</li>
<li>develop ways of extracting the necessary information needed for the detection:
<ul>
<li>trades on two of the largest NFT marketplaces (OpenSea and <a href="https://looksrare.org/">LooksRare</a>)</li>
<li>Ether transfers for each of the accounts involved in the trade</li>
</ul></li>
<li>serve as a starting point for the creation of detection algorithms</li>
</ul>
<p><strong>Methodology</strong> for accomplishing those goals consists of</p>
<ul>
<li>taking into account only Ethereum’s on-chain transactions when discussing ways a wash trade can be made</li>
<li>using <a href="https://docs.etherscan.io/">Etherscan</a> and <a href="https://docs.alchemy.com/alchemy/">Alchemy</a> APIs to enable the data collection process</li>
<li>using Python programming language for the implementation part</li>
</ul>
</section>
<section id="results-discussion" class="level1">
<h1>Results &amp; Discussion</h1>
<section id="wash-trading-patterns" class="level3">
<h3 class="anchored" data-anchor-id="wash-trading-patterns">Wash Trading Patterns</h3>
<p>The explanation for the diagrams used in this paper is the following:</p>
<ul>
<li>White circles with a letter inside them are addresses that are considered</li>
<li>Address can be connected with multiple lines</li>
<li>The line that has the <strong>NFT</strong> written on it signals that those two addresses were involved in an NFT trade</li>
<li>The line containing a number <strong>n</strong> on it signals that exists an Ether transfer trail between those addresses through <strong>n</strong> intermediaries
<ul>
<li>if <strong>n</strong> = 0 that is a direct transfer</li>
<li>if <strong>n</strong> = 1 there is a transfer trail involving one intermediary address</li>
</ul></li>
<li>Lines with an arrow care about the direction of a transfer and point to the new owner’s address</li>
<li>Lines without an arrow do not care about the direction</li>
</ul>
<p>Shown on <em>Figure 1</em> there are two “meta-patterns” that this paper considers.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/ERFC-90/images/meta-patterns.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">meta-patterns</figcaption><p></p>
</figure>
</div>
<p><em>Figure 1 - Considered Meta-patterns</em></p>
</center>
<p>Meta-patterns can be expanded into specific patterns that care about the direction of those transfers (<em>Figure 2</em>). While some patterns may be more suspicious than others, all of them can be used for the purpose of wash trading. For example <em>pattern 2.2</em> can mean that after making a wash trade and selling the NFT to someone else, addresses <strong>A</strong> and <strong>B</strong> send all of their funds to address <strong>C</strong>.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/ERFC-90/images/expanded-patterns.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">expanded-patterns</figcaption><p></p>
</figure>
</div>
<p><em>Figure 2 - Expanded patterns</em></p>
</center>
<p>The reason that all of these patterns do not take the time order of transfers into account is that it doesn’t matter - they need to detect only the connections between addresses.</p>
</section>
<section id="collecting-and-parsing-of-data" class="level2">
<h2 class="anchored" data-anchor-id="collecting-and-parsing-of-data">Collecting and Parsing of Data</h2>
<p>This research takes into account only trades of NFTs that follow the ERC721 standard. The same principles can be applied to the trades involving the ERC1155 standard, with the only difference being the collection and parsing of trades.</p>
<p>When an NFT trade is executed, the ERC721 compliant contracts emit a <strong>Transfer event</strong> that contains three fields: previous owner, new owner, and the token id. Using the combination of Etherscan and Alchemy APIs, it is possible to get all the events that were emitted by the transaction and to extract the needed event based on its topic along with all of its fields.</p>
<p>Not every Transfer event corresponds to a trade, so there needs to be an extra processing step that will eliminate all transfers that were not made through a marketplace. To do this, one needs to go through all of the marketplace’s contract’s transactions and select only those that have the right <strong>methodID</strong>.</p>
<p>After the seller’s (previous owner’s) and buyer’s (new owner’s) addresses are known, the last step is collecting and parsing of all of their transactions searching for Ether transfers and all the addresses they have interacted with - in this paper referred to as “associates”.</p>
</section>
<section id="wash-trading-detectors" class="level2">
<h2 class="anchored" data-anchor-id="wash-trading-detectors">Wash Trading Detectors</h2>
<p>Having a set of all of the buyer’s and seller’s associates enables the creation of <strong>Wash Trading Detectors (WTD)</strong>. This paper proposes and implements two basic algorithms:</p>
<ul>
<li><strong>WTD0</strong> that detects a direct transfer by checking if the seller’s address belongs to the set of buyer’s associates</li>
<li><strong>WTD1*</strong> that detects a set of common associates that are Externally Owned Accounts (EOAs)</li>
</ul>
<p>*WTD1 is incomplete because the detected common associate can be a Centralized Exchange’s (CEX) address which would give a false positive. The only way to make the WTD1 fully functional is to manually keep a list of all the addresses that should be ignored.</p>
</section>
<section id="implementation" class="level2">
<h2 class="anchored" data-anchor-id="implementation">Implementation</h2>
<p>Using the proposed ways of getting the data and reasoning on it, it is possible to extract suspicious wash trading patterns, flag those trades, and perform an analysis of the results. The code shown bellow is capable of getting the count of detected wash trades performed through a marketplace in a given block range :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> utils</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run(contract, methodIds, start_block, end_block):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Detects potential Wash trades for a marketplace's contract'''</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    transactions <span class="op">=</span> utils.get_all_transactions(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        contract,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        start_block,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        end_block</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    wtd0_count, wtd1_count, total <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>  tx <span class="kw">in</span> transactions:</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> tx[<span class="st">'input'</span>][:<span class="dv">10</span>] <span class="kw">in</span> methodIds:</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            status, logs <span class="op">=</span> utils.get_logs(tx[<span class="st">'hash'</span>])</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> status <span class="op">!=</span> <span class="dv">1</span>: <span class="co"># Reverted transaction</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            nft_contract, token_id, A, B <span class="op">=</span> utils.parse_logs(logs)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> A <span class="op">==</span> <span class="va">None</span> <span class="kw">or</span> B <span class="op">==</span> <span class="va">None</span>: <span class="co"># not a standard ERC721</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            associates_A <span class="op">=</span> utils.get_associates(A)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            associates_B <span class="op">=</span> utils.get_associates(B)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            wtd0_count <span class="op">+=</span> <span class="bu">int</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                utils.wtd0(A, B, associates_A, associates_B)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            wtd1_count <span class="op">+=</span> <span class="bu">int</span>(</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                <span class="bu">len</span>(utils.wtd1(A, B, associates_A, associates_B)) <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (wtd0_count, wtd1_count, total)</span></code></pre></div>
<p>The <code>run</code> function consists of getting all transaction data for a marketplace’s contract starting from the <code>start_block</code> up to the <code>end_block</code> and considering only those that are in the provided list of <code>methodIds</code>. These transactions are then parsed, and values are extracted that will be passed to the <code>utils.wtd0</code> and <code>utils.wtd1</code> functions which will perform detection.</p>
<p>For the full implementation of all of the used helper methods from <code>utils</code> module see <a href="#appendix-a">Appendix A</a>.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>For example, let us take the <a href="https://etherscan.io/address/0x7Be8076f4EA4A4AD08075C2508e481d6C946D12b">OpenSea’s Wyvern V1 contract</a> and pass three different block ranges. The <code>['0xab834bab']</code> argument corresponds to the <code>methodID</code> of the contract’s method that gets called when there is a trade.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>WYVERN_V1 <span class="op">=</span> <span class="st">'0x7Be8076f4EA4A4AD08075C2508e481d6C946D12b'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ranges <span class="op">=</span> [</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">6652089</span>, <span class="dv">6652239</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">7486211</span>, <span class="dv">7486311</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">7704798</span>, <span class="dv">7704898</span>],</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_block, end_block <span class="kw">in</span> ranges:</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(run(WYVERN_V1, [<span class="st">'0xab834bab'</span>], start_block, end_block))</span></code></pre></div>
<p>From the total of <strong>23</strong> trades that were made during the provided ranges :</p>
<ul>
<li>WTD0 flags <strong>8</strong> trades</li>
<li>WTD1 flags <strong>11**</strong> trades</li>
</ul>
<p>**WTD1 returns a list of associate addresses; these lists were manually checked through Etherscan to see if they belong to a CEX. The list of ignored addresses is available in <a href="#appendix-b">Appendix B</a>.</p>
</section>
<section id="implications" class="level3">
<h3 class="anchored" data-anchor-id="implications">Implications</h3>
<p>The sample size of <strong>23</strong> is too small to discuss how the reported numbers relate to all of the NFT trades since the marketplace’s contract deployment. The code itself can, however, serve as a starting point for the development of a service capable of extracting the data from all of the NFT marketplaces since their creation. In that data lies the key to answering not only what trades are a wash trade but also who performed them, how many times was an address linked to a wash trade, whether one NFT has been wash traded multiple times, etc. Such a service would need to effectively manage its resources such as the collection of data and the computation needed in the detection - in the example above, set of associates is always computed from scratch (there is no storing of the result and checking if those values have already been computed). The full specification for the development of this service is out of the scope of this paper and should be a topic of a separate research.</p>
<section id="complex-patterns" class="level4">
<h4 class="anchored" data-anchor-id="complex-patterns">Complex Patterns</h4>
<p>Due to current non-negligible transaction fees on Ethereum and the fact that not many people are deeply looking into each trade, it is unlikely that there are complex patterns present in NFT wash trading. As the fees get lower and as the adoption grows, it’s almost certain that they will emerge. On the <em>Figure 3</em> is shown one pattern that could be used in the process of wash trading.</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../assets/ERFC-90/images/complex-pattern.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">complex-pattern</figcaption><p></p>
</figure>
</div>
<p><em>Figure 3 - Complex pattern</em></p>
</center>
<p>There are two NFT wash trades present (marked by the black and blue colored arrows). The sequence of transfers is the following:</p>
<ol type="1">
<li><strong>A</strong> finances <strong>B</strong> and <strong>C</strong> through 3 and 2 intermediaries, respectively</li>
<li><strong>B</strong> finances <strong>D</strong> through 3 intermediaries</li>
<li><strong>D</strong> buys an NFT from some non-associated address</li>
<li><strong>D</strong> sells the NFT to <strong>C</strong></li>
<li><strong>D</strong> sends the funds to <strong>B</strong> through the same 3 intermediaries that were used before</li>
<li><strong>B</strong> finances <strong>E</strong> through 2 intermediaries</li>
<li><strong>E</strong> buys the NFT from <strong>C</strong></li>
</ol>
<p>After the last step, <strong>E</strong> can sell the NFT to an unsuspecting victim. It is important to note that addresses used do not have to be discarded after each wash trade - i.e.&nbsp;<strong>B</strong> can be used just for routing of the funds. Furthermore, a malevolent entity can inflate the prices of not just a single NFT but for a complete collection, making it look like the collection is very popular, which attracts victims.</p>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>This research shows that it is possible to flag a specific trade as being a wash trade. The proposed algorithms can serve as a starting point in this process. To flag a specific NFT as being wash traded there would need to exist a list of all the trades of that NFT. This could be done via a service that would enable the users to browse the history of trades of any NFT on every marketplace and see all of the connections between the addresses that once owned it. If the service is built and popularized while keeping its inner workings public, the malevolent parties would try to evade detection which would lead to the need to constantly improve the algorithm.</p>
</section>
<section id="appendices" class="level1">
<h1>Appendices</h1>
<section id="appendix-a" class="level2">
<h2 class="anchored" data-anchor-id="appendix-a">Appendix A</h2>
<p>Implementation of the <code>utils</code> module.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time, json, requests</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> web3 <span class="im">import</span> Web3</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"alchemy-url"</span> : <span class="st">""</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"etherscan-api-key"</span>: <span class="st">""</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>web3 <span class="op">=</span> Web3(Web3.HTTPProvider(config[<span class="st">'alchemy-url'</span>]))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_transactions(address, start_block <span class="op">=</span> <span class="dv">0</span>, end_block <span class="op">=</span> <span class="dv">19999999</span>):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Gets all transactions using Etherscan API for the provided address'''</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    transactions <span class="op">=</span> []</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">5</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> requests.get(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'https://api.etherscan.io/api?module=account&amp;action=txlist'</span> <span class="op">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'&amp;address=</span><span class="sc">{</span>address<span class="sc">}</span><span class="ss">'</span> <span class="op">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'&amp;startblock=</span><span class="sc">{</span>start_block<span class="sc">}</span><span class="ss">'</span> <span class="op">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'&amp;endblock=</span><span class="sc">{</span>end_block<span class="sc">}</span><span class="ss">'</span> <span class="op">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'&amp;offset=</span><span class="sc">{</span><span class="dv">1_000</span><span class="sc">}</span><span class="ss">'</span> <span class="op">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'&amp;sort=</span><span class="sc">{</span><span class="st">"asc"</span><span class="sc">}</span><span class="ss">'</span> <span class="op">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'apikey=</span><span class="sc">{</span>config[<span class="st">"etherscan-api-key"</span>]<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        ).json()[<span class="st">'result'</span>]</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        transactions <span class="op">+=</span> result</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(result) <span class="op">&lt;</span> <span class="dv">1_000</span>:</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        start_block <span class="op">=</span> <span class="bu">int</span>(result[<span class="op">-</span><span class="dv">1</span>][<span class="st">"blockNumber"</span>]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transactions</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_EOA(address):</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Returns true if the address belongs to an Externally Owned Account'''</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        _address <span class="op">=</span> Web3.toChecksumAddress(address)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> web3.eth.getCode(_address) <span class="op">==</span> <span class="st">b""</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_associates(address):</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Returns a set of all account with which the provided addresses interacted with'''</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    transactions <span class="op">=</span> get_all_transactions(address)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    associates <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tx <span class="kw">in</span> transactions:</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> tx[<span class="st">'from'</span>] <span class="op">!=</span> address:</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            associates.update([tx[<span class="st">'from'</span>]])</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> tx[<span class="st">'to'</span>] <span class="op">!=</span> address:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            associates.update([tx[<span class="st">'to'</span>]])</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> associates</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_logs(tx_hash):</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Gets the logs from the transaction receipt of the tx_hash'''</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    tx_receipt <span class="op">=</span> web3.eth.get_transaction_receipt(tx_hash)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tx_receipt[<span class="st">'status'</span>], tx_receipt[<span class="st">'logs'</span>]</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_logs(logs):</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Returns the NFT contract's address, token id and addresses involved in the trade'''</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    TRANSFER_TOPIC <span class="op">=</span> <span class="st">"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    WRAPPED_ETH <span class="op">=</span> <span class="st">"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    nft_contracts, token_ids, _from, _to <span class="op">=</span> [], [], <span class="va">None</span>, <span class="va">None</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ev <span class="kw">in</span> logs:</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> TRANSFER_TOPIC <span class="op">==</span> ev[<span class="st">"topics"</span>][<span class="dv">0</span>].<span class="bu">hex</span>() <span class="kw">and</span> ev[<span class="st">"address"</span>] <span class="op">!=</span> WRAPPED_ETH:</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            nft_contracts.append(ev[<span class="st">"address"</span>])</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>            bytecode <span class="op">=</span> <span class="st">""</span>.join([x.<span class="bu">hex</span>() <span class="cf">for</span> x <span class="kw">in</span> ev[<span class="st">"topics"</span>]]) <span class="op">+</span> <span class="st">""</span>.join(ev[<span class="st">"data"</span>])</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>            _from <span class="op">=</span> <span class="st">"0x"</span> <span class="op">+</span> bytecode[<span class="dv">66</span> : <span class="dv">66</span> <span class="op">*</span> <span class="dv">2</span>][<span class="op">-</span><span class="dv">40</span>:]</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>            _to <span class="op">=</span> <span class="st">"0x"</span> <span class="op">+</span> bytecode[<span class="dv">66</span> <span class="op">*</span> <span class="dv">2</span> : <span class="dv">66</span> <span class="op">*</span> <span class="dv">3</span>][<span class="op">-</span><span class="dv">40</span>:]</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>            token_ids.append(<span class="bu">int</span>(bytecode[<span class="dv">66</span> <span class="op">*</span> <span class="dv">3</span> : <span class="dv">66</span> <span class="op">*</span> <span class="dv">4</span>][<span class="dv">2</span>:<span class="dv">66</span>], base<span class="op">=</span><span class="dv">16</span>))</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nft_contracts, token_ids, _from, _to</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wtd0(A, B, associates_A, associates_B):</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''WTD0 implementation'''</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (A <span class="kw">in</span> associates_B) <span class="kw">or</span> (B <span class="kw">in</span> associates_A)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wtd1(A, B, associates_A, associates_B):</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''WTD1 implementation'''</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    EOA_associates <span class="op">=</span> []</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    common_associates <span class="op">=</span> associates_A.intersection(associates_B)</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ca <span class="kw">in</span> common_associates:</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_EOA(ca):</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>            EOA_associates.append(ca)</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> EOA_associates</span></code></pre></div>
</section>
<section id="appendix-b" class="level2">
<h2 class="anchored" data-anchor-id="appendix-b">Appendix B</h2>
<p>Following is the list of all the addresses that were ignored by WTD1 due to the fact that they belong to CEXs</p>
<center>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Address</th>
<th style="text-align: center;">CEX</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0x564286362092d8e7936f0549571a803b203aaced</td>
<td style="text-align: center;">Binance3</td>
</tr>
<tr class="even">
<td style="text-align: center;">0x59a5208b32e627891c389ebafc644145224006e8</td>
<td style="text-align: center;">HitBTC2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0x56eddb7aa87536c09ccc2793473599fd21a8b17f</td>
<td style="text-align: center;">Binance17</td>
</tr>
<tr class="even">
<td style="text-align: center;">0xeb2629a2734e272bcc07bda959863f316f4bd4cf</td>
<td style="text-align: center;">Coinbase6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0xd551234ae421e3bcba99a0da6d736074f22192ff</td>
<td style="text-align: center;">Binance2</td>
</tr>
<tr class="even">
<td style="text-align: center;">0xb5d85cbf7cb3ee0d56b3bb207d5fc4b82f43f511</td>
<td style="text-align: center;">Coinbase5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0x0681d8db095565fe8a346fa0277bffde9c0edbbf</td>
<td style="text-align: center;">Binance4</td>
</tr>
<tr class="even">
<td style="text-align: center;">0x3f5ce5fbfe3e9af3971dd833d26ba9b5c936f0be</td>
<td style="text-align: center;">Binance</td>
</tr>
</tbody>
</table>
</center>
</section>
</section>
<section id="bibliography" class="level1">
<h1>Bibliography</h1>


</section>

<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p><a href="#ref-haywardOpenSeaHitsRecord2022"><strong>haywardOpenSeaHitsRecord2022?</strong></a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="#ref-WashTradingDefinition"><strong>WashTradingDefinition?</strong></a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

</script>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="0x3327/research" data-repo-id="R_kgDOG-cOHQ" data-category="Research" data-category-id="DIC_kwDOG-cOHc4COB27" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Proudly supported by <a href="https://mvpworkshop.co"><img src="https://mvpworkshop.co/wp-content/uploads/2021/01/mvp-logo.png" class="img-fluid" width="65"></a></div>   
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">About</a>
  </li>  
</ul>
      </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/3327_io">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/0x3327/research">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>


</body></html>